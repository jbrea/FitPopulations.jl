<div align="center">

# LaplacianExpectationMaximization

[![Documentation](https://img.shields.io/badge/docs-main-blue.svg)](https://jbrea.github.io/LaplacianExpectationMaximization.jl/dev)
[![build](https://github.com/jbrea/LaplacianExpectationMaximization.jl/workflows/CI/badge.svg)](https://github.com/jbrea/LaplacianExpectationMaximization.jl/actions?query=workflow%3ACI)
[![codecov.io](http://codecov.io/github/jbrea/LaplacianExpectationMaximization.jl/coverage.svg?branch=main)](http://codecov.io/github/jbrea/LaplacianExpectationMaximization.jl?branch=master)
[![Aqua QA](https://raw.githubusercontent.com/JuliaTesting/Aqua.jl/master/badge.svg)](https://github.com/JuliaTesting/Aqua.jl)
[![](https://img.shields.io/badge/%F0%9F%9B%A9%EF%B8%8F_tested_with-JET.jl-ffffff)](https://github.com/aviatesk/JET.jl)
<!-- Tidyverse lifecycle badges, see https://www.tidyverse.org/lifecycle/ Uncomment or delete as needed. -->
<!--
![lifecycle](https://img.shields.io/badge/lifecycle-maturing-blue.svg)
![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)
![lifecycle](https://img.shields.io/badge/lifecycle-stable-green.svg)
![lifecycle](https://img.shields.io/badge/lifecycle-retired-orange.svg)
![lifecycle](https://img.shields.io/badge/lifecycle-archived-red.svg)
![lifecycle](https://img.shields.io/badge/lifecycle-dormant-blue.svg) -->
<!-- travis-ci.com badge, uncomment or delete as needed, depending on whether you are using that service. -->
<!-- [![Build Status](https://travis-ci.com/jbrea/LaplacianExpectationMaximization.jl.svg?branch=master)](https://travis-ci.com/jbrea/LaplacianExpectationMaximization.jl) -->
<!-- Coverage badge on codecov.io, which is used by default. -->
<!-- Documentation -- uncomment or delete as needed -->
<!--
[![Documentation](https://img.shields.io/badge/docs-stable-blue.svg)](https://jbrea.github.io/LaplacianExpectationMaximization.jl/stable)
-->
<!-- Aqua badge, see test/runtests.jl -->
</div>

This package implements the Expectation-Maximization (EM) algorithm with a Laplacian approximation for the E-step, as described e.g. [here](http://dx.doi.org/10.1371/journal.pcbi.1002410), for finding the maximum likelihood estimate of the parameter distribution of a model.

Assume some data $\mathcal D = \{\boldsymbol x_1, \ldots, \boldsymbol x_n\}$ was generated by sampling independently from the conditional density $\boldsymbol x_i\sim p(\boldsymbol x|\boldsymbol \theta_i)$, where $\boldsymbol \theta_i$ are parameters sampled from a multivariate normal distribution with diagonal covariance $\boldsymbol \theta_i\sim\mathcal N(\boldsymbol \theta; \boldsymbol \mu, \boldsymbol\sigma)$. This package allows to find the maximum likelihood estimates 
$$
\begin{align*}
\boldsymbol \mu^*, \boldsymbol \sigma^* = \arg\max_{\boldsymbol \mu, \boldsymbol\sigma}p(\mathcal D | \boldsymbol\mu, \boldsymbol \sigma) &= \arg\max_{\boldsymbol \mu, \boldsymbol\sigma}\sum_{i=1}^n\log(p(\boldsymbol x_i|\boldsymbol\mu, \boldsymbol\sigma))\\ &= \arg\max_{\boldsymbol \mu, \boldsymbol\sigma}\sum_{i=1}^n\log\left(\int p(\boldsymbol x_i|\boldsymbol \theta_i)\mathcal N(\boldsymbol\theta_i;\boldsymbol\mu, \boldsymbol\sigma)d\boldsymbol\theta_i\right)
\end{align*}
$$
using the EM algorithm with Laplacian approximation for the E-step.

The logarithm of the conditional density $p(\boldsymbol x|\boldsymbol \theta)$ should be given in the form of a method `LaplacianExpectationMaximization.logp(data, model::MyModel, parameters)`, where the argument `model` can contain internal states that are used to compute the log density. See [documentation](https://jbrea.github.io/LaplacianExpectationMaximization.jl/dev) for examples.
